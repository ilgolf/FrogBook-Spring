# Day_24

## DIP - 의존 역전 원칙

> "고차원 모듈은 저차원 모듈에 의존하면 안된다. 이 두 모듈 모두 다른 추상화 된 것에 의존해야 한다."

"추상화 된 것은 구체적인 것에 의존하면 안 된다. 구체적인 것이 추상화 된 것에 의존해야 한다."

"자주 변경되는 구체 클래스에 의존하지 마라" - 로버트 C.마틴
> 

자동차와 스노우타이어 사이에는 밑에 그림처럼 의존 관계가  있다. 자동차가 스노우타이어에 의존한다.

<img src="/static/5-16.png" width="767px" height="128px"></img>

그런데 자동차는 한 번 사면 몇 년은 타야 하는데 스노우타이어는 계절이 바뀌면 일반 타이어로 교체해야 한다. 이런 경우 스노우타이어를 일반 타이어로 교체할 때 자동차는 그 영향에 노출돼 있음을 알 수 있다. 그렇다면 나쁜 냄새가 좋은 향기가 되도록 개선해보자.

<img src="/static/5-17.PNG" width="513px" height="349px"></img>

위 그림과 같이 자동차가 구체적인 타이어들(스노우타이어, 일반 타이어, 광폭 타이어)이 아닌 추상화된 타이어 인터페이스에만 의존함으로써 스노우타이어에서 일반 타이어로, 또는 다른 구체적인 타이어로 변경돼도 자동차는 이제 그 영향을 받지 않는 형태로 구성된다. 그런데 이 설명에서 데자뷰가 느껴질 것이다. 개방 폐쇄 원칙을 설명할 때 나온 설명이다. 이렇게 하나하나 해결책을 찾으면 그 안에 여러 설계 원칙이 녹아있는 경우가 많다. 

그런데 리펙토링 전 그림을 살펴보면 스노우타이어가 무엇에도 의존하지 않는 클래스였는데, 추상적인 것인 타이어 인터페이스에 의존하게 됐다. 바로 의존의 방향이 역전된 것이다. 그리고 자동차는 자신보다 변하기 쉬운 스노우타이어에 의존하던 관계를 중간에 인터페이스를 추가해 두고 의존 관계를 역전 시키고 있다. 이처럼 자신보다 변하기 쉬운 것에 의존하던 것을 추상화된 인터페이스나 상위 클래스를 두어 변하기 쉬운 것에 변화에 영향 받지 않게 하는 것이 의존 역전 원칙이다.

의존 역전 원칙을 의역해 보면 다음과 같다.

> "자신보다 변하기 쉬운 것에 의존하지 마라."
> 

 상위 클래스일수록, 인터페이스일수록, 추상 클래스일수록 변하지 않을 가능성이 높기에 하위 클래스나 구체 클래스가 아닌 상위 클래스, 인터페이스, 추상 클래스를 통해 의존하라는 것이 바로 의존 역전 원칙이다.